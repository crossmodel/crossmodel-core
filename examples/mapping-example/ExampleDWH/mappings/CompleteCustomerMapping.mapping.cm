mapping:
    id: CompleteCustomerMapping
    sources:
      - id: CustomerSourceObject
        entity: ExampleCRM.Customer
        join: from
      - id: CalcAgeSourceObject
        entity: ExampleDWH.CalcAge
        join: apply
        dependencies:
          - CustomerSourceObject
        conditions:
          - CalcAgeSourceObject.BirthDate = CustomerSourceObject.Birth_Date
    target:
        entity: ExampleDWH.CompleteCustomer
        mappings:
          - attribute: Country
            sources:
              - CustomerSourceObject.Country
          - attribute: FixedNumber
            expressions:
              - language: "SQL"
                expression: "1"
          - attribute: FixedString
            expressions:
              - language: "SQL"
                expression: "Hoppa"
          - attribute: Name
            sources:
              - CustomerSourceObject.First_Name
              - CustomerSourceObject.Last_Name
            expressions:
              - language: "SQL"
                expression: "CONCAT_WS({{CustomerSourceObject.First_Name}}, {{CustomerSourceObject.Last_Name}}, ' ')"
          - attribute: Age
            sources:
              - CustomerSourceObject.Birth_Date
            expressions:
              - language: "SQL"
                expression: "DATEDIFF(YEAR, NOW(), {{CustomerSourceObject.Birth_Date}})"
          - attribute: Today
            expressions:
              - language: "SQL"
                expression: "GETDATE()"